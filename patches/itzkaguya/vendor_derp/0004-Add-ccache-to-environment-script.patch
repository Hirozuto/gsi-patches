From 308aefd3dae035a3688aca1254c297306cb38bc1 Mon Sep 17 00:00:00 2001
From: Raka Prasetya Pratama <madeayurenapramudya@gmail.com>
Date: Thu, 2 Mar 2023 14:22:49 +0000
Subject: [PATCH 4/4] Add ccache to environment script

---
 build/envsetup.sh | 21 +++++++++++++++++++--
 1 file changed, 19 insertions(+), 2 deletions(-)

diff --git a/build/envsetup.sh b/build/envsetup.sh
index fb29dfd2..371dd902 100644
--- a/build/envsetup.sh
+++ b/build/envsetup.sh
@@ -104,9 +104,26 @@ function fixup_common_out_dir() {
     fi
 }
 
+# Check and set ccache path on envsetup
+if [ -z ${CCACHE_EXEC} ]; then
+	ccache_path=$(which ccache)
+	if [ ! -z "$ccache_path" ]; then
+		mkdir /mnt/ccache
+		mount --bind ~/.ccache /mnt/ccache
+		export USE_CCACHE=1
+		export CCACHE_COMPRESS=1
+		export CCACHE_EXEC=/usr/bin/ccache
+		export CCACHE_DIR=/mnt/ccache
+		ccache -M 50G -F 0
+		echo "ccache found and CCACHE_EXEC has been set to : $ccache_path"
+	else
+		echo "ccache not found/installed!"
+	fi
+fi
+
 # Disable ABI checking
 export SKIP_ABI_CHECKS=true
 
 # Override host metadata to make builds more reproducible and avoid leaking info
-export BUILD_HOSTNAME=derpbox
-export BUILD_USERNAME=private
+export BUILD_HOSTNAME=itzkaguya
+export BUILD_USERNAME=segawa
-- 
2.37.3

